**Given:** 
- It's an MX and management server for the internal network.
- We need to find the password for the user HTB.

## Nmap scan

```
┌─[root@parrot]─[~/Footprinting-Hard]
└──╼ #nmap -sC -sV 10.129.4.95 -oA nmap_scan
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-12-29 20:47 IST
Nmap scan report for 10.129.4.95
Host is up (1.0s latency).
Not shown: 995 closed tcp ports (reset)
PORT    STATE SERVICE  VERSION
22/tcp  open  ssh      OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey:
|   3072 3f:4c:8f:10:f1:ae:be:cd:31:24:7c:a1:4e:ab:84:6d (RSA)
|   256 7b:30:37:67:50:b9:ad:91:c0:8f:f7:02:78:3b:7c:02 (ECDSA)
|_  256 88:9e:0e:07:fe:ca:d0:5c:60:ab:cf:10:99:cd:6c:a7 (ED25519)
110/tcp open  pop3     Dovecot pop3d
|_ssl-date: TLS randomness does not represent time
| ssl-cert: Subject: commonName=NIXHARD
| Subject Alternative Name: DNS:NIXHARD
| Not valid before: 2021-11-10T01:30:25
|_Not valid after:  2031-11-08T01:30:25
|_pop3-capabilities: RESP-CODES STLS AUTH-RESP-CODE UIDL TOP SASL(PLAIN) PIPELINING USER CAPA
143/tcp open  imap     Dovecot imapd (Ubuntu)
|_ssl-date: TLS randomness does not represent time
| ssl-cert: Subject: commonName=NIXHARD
| Subject Alternative Name: DNS:NIXHARD
| Not valid before: 2021-11-10T01:30:25
|_Not valid after:  2031-11-08T01:30:25
|_imap-capabilities: post-login STARTTLS OK ID have LOGIN-REFERRALS LITERAL+ more listed SASL-IR IDLE AUTH=PLAINA0001 capabilities Pre-login ENABLE IMAP4rev1
993/tcp open  ssl/imap Dovecot imapd (Ubuntu)
|_ssl-date: TLS randomness does not represent time
|_imap-capabilities: post-login OK ID have LOGIN-REFERRALS LITERAL+ more listed SASL-IR IDLE AUTH=PLAINA0001 capabilities Pre-login ENABLE IMAP4rev1
| ssl-cert: Subject: commonName=NIXHARD
| Subject Alternative Name: DNS:NIXHARD
| Not valid before: 2021-11-10T01:30:25
|_Not valid after:  2031-11-08T01:30:25
995/tcp open  ssl/pop3 Dovecot pop3d
| ssl-cert: Subject: commonName=NIXHARD
| Subject Alternative Name: DNS:NIXHARD
| Not valid before: 2021-11-10T01:30:25
|_Not valid after:  2031-11-08T01:30:25
|_ssl-date: TLS randomness does not represent time
|_pop3-capabilities: USER RESP-CODES UIDL TOP SASL(PLAIN) CAPA PIPELINING AUTH-RESP-CODE
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 38.20 seconds
┌─[root@parrot]─[~/Footprinting-Hard]
└──╼ #
```

### Scan result : 

|**Port**|**State**|**Service**|**Version Details**|**Key Info**|
|---|---|---|---|---|
|**22**|Open|**SSH**|OpenSSH 8.2p1 (Ubuntu)|Remote access; standard keys found.|
|**110**|Open|**POP3**|Dovecot pop3d|Unencrypted mail retrieval.|
|**143**|Open|**IMAP**|Dovecot imapd|Unencrypted mail access.|
|**993**|Open|**IMAPS**|Dovecot imapd (SSL/TLS)|Secure mail access.|
|**995**|Open|**POP3S**|Dovecot pop3d (SSL/TLS)|Secure mail retrieval.|
- I also performed a udp scan : 
```bash
─[root@parrot]─[~/Footprinting-Hard]
└──╼ #cat udp_scan
# Nmap 7.94SVN scan initiated Tue Dec 30 09:39:04 2025 as: nmap -sC -sV -sU -o udp_scan 10.129.158.216
Nmap scan report for 10.129.158.216
Host is up (0.18s latency).
Not shown: 998 closed udp ports (port-unreach)
PORT    STATE         SERVICE VERSION
68/udp  open|filtered dhcpc
161/udp open          snmp    net-snmp; net-snmp SNMPv3 server
| snmp-info:
|   enterprise: net-snmp
|   engineIDFormat: unknown
|   engineIDData: 5b99e75a10288b6100000000
|   snmpEngineBoots: 10
|_  snmpEngineTime: 19m31s

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Tue Dec 30 09:57:47 2025 -- 1 IP address (1 host up) scanned in 1122.95 seconds
```

|**Port**|**State**|**Service**|**Version Details**|**Key Info**|
|---|---|---|---|---|
|**68/udp**|Open/Filtered|**DHCP**|dhcpc|Standard DHCP client activity. Usually not an attack vector.|
|**161/udp**|**Open**|**SNMP**|net-snmp (SNMPv3)|**High Priority.** Used for network monitoring and device info.|

- We have SNMP open as well..
- Let's try using snmpwalk..
![[Pasted image 20251230100142.png]]
- We're getting a timeout error here! so public string does not work.. we can try community strings with onesixtyone bruteforcing..
```bash
onesixtyone -c /usr/share/wordlists/seclists/Discovery/SNMP/snmp.txt 10.129.158.216
```

- we found a community string backup..!!
![[Pasted image 20251230100332.png]]
- now we can try snmpwalk with our new found community string..!!
- We can now try snmpwalk with our new found community string `backup`
![[Pasted image 20251230100657.png]]
