# NFS

Network File System - has the same purpose as SMB but used in Linux and Unix systems.

- Cannot communicate directly with SMB servers
- Has no mechanism for authentication or authorization, instead authentication is completely shifted to the RPC protocol's options
- Most common authentication is via Unix UID/GID and group permissions

![[attachments/Pasted image 20251222044403.png]]

---

## Footprinting the Service

```bash
sudo nmap 10.129.14.128 -p111,2049 -sV -sC
```

```bash
sudo nmap --script nfs* 10.129.14.128 -sV -p111,2049
```

## Mounting NFS Shares

Once we have discovered such an NFS service, we can mount it on our local machine. First, create a new empty folder to which NFS share will be mounted:

### Show Available Exports

```bash
showmount -e 10.129.14.128
```

### Mount the Share

```bash
mkdir target-NFS
sudo mount -t nfs 10.129.14.128:/ ./target-NFS/ -o nolock
cd target-NFS
```

## Enumerating Permissions

We can access the rights and the usernames and groups to whom the shown and viewable files belong. Once we have the usernames, group names, UIDs, and GUIDs, we can create them on our system and adapt them to the NFS share to view and modify the files.

### List Contents with Usernames & Group Names

```bash
ls -l mnt/nfs
```

### List Contents with UIDs & GUIDs

```bash
ls -n mnt/nfs/
```

## Privilege Escalation via NFS

We can also use NFS for further escalation. For example, if we have access to the system via SSH and want to read files from another folder that a specific user can read, we would need to upload a shell to the NFS share that has the `SUID` of that user and then run the shell via the SSH user.

## Unmounting

```bash
sudo umount ./target-NFS
```

---

See also: [[5. FTP]], [[6. SMB]]
