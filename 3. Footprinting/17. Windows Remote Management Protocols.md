
The main components used for remote management of Windows and Windows servers are the following:

- Remote Desktop Protocol (`RDP`)
    
- Windows Remote Management (`WinRM`)
    
- Windows Management Instrumentation (`WMI`)
- port `3389`

## Footprinting the service 

```bash
nmap -sV -sC 10.129.201.248 -p3389 --script rdp*
```

## RDP Security Check

```bash
git clone https://github.com/CiscoCXSecurity/rdp-sec-check.git && cd rdp-sec-check

./rdp-sec-check.pl 10.129.201.248
```

#### Initiate an RDP Session

```bash
HrithikManoj000@htb[/htb]$ xfreerdp /u:cry0l1t3 /p:"P455w0rd!" /v:10.129.201.248

xfreerdp /u:htb-student /p:'HTB_@cademy_stdnt!' /v:10.129.204.126 /cert:ignore

xfreerdp /u:htb-student /p:HTB_@cademy_stdnt! /v:10.129.204.126 /cert-ignore /bpp:8 /network:modem /compression -themes -wallpaper /clipboard /audio-mode:1 /auto-reconnect -glyph-cache /dynamic-resolution

```

## WinRM

> Windows Remote Management

- Simple windows integrated remote management protocol based on the command line.
- ports `5985` and `5986`

## Footprinting the service 

```bash
nmap -sV -sC 10.129.201.248 -p5985,5986 --disable-arp-ping -n
```

we can use the tool called [evil-winrm](https://github.com/Hackplayers/evil-winrm), another penetration testing tool designed to interact with WinRM.

```bash
evil-winrm -i 10.129.201.248 -u Cry0l1t3 -p P455w0rD!
```

## WMI

### Footprinting the service

- port `135`
- program [wmiexec.py](https://github.com/SecureAuthCorp/impacket/blob/master/examples/wmiexec.py) from the Impacket toolkit can be used for this.

```bash
/usr/share/doc/python3-impacket/examples/wmiexec.py Cry0l1t3:"P455w0rD!"@10.129.201.248 "hostname"
```

