## Cracking encrypted SSH keys

```
ssh2john.py SSH.private > ssh.hash
john --wordlist=rockyou.txt ssh.hash
```

**View result:** 
```shell-session
john --wordlist=rockyou.txt ssh.hash
```

## Cracking password protected documents

```shell-session
HrithikManoj000@htb[/htb]$ office2john.py Protected.docx > protected-docx.hash
HrithikManoj000@htb[/htb]$ john --wordlist=rockyou.txt protected-docx.hash
HrithikManoj000@htb[/htb]$ john protected-docx.hash --show
```

```shell-session
HrithikManoj000@htb[/htb]$ pdf2john.py PDF.pdf > pdf.hash
HrithikManoj000@htb[/htb]$ john --wordlist=rockyou.txt pdf.hash
HrithikManoj000@htb[/htb]$ john pdf.hash --show
```


# Cracking protected archives

### Cracking zip files

```shell-session
[!bash!]$ zip2john ZIP.zip > zip.hash
[!bash!]$ cat zip.hash
john --wordlist=rockyou.txt zip.hash
```

```shell-session
for i in $(cat rockyou.txt);do openssl enc -aes-256-cbc -d -in GZIP.gzip -k $i 2>/dev/null| tar xz;done
```

## Cracking BitLocker-encrypted drives

```shell-session
[!bash!]$ bitlocker2john -i Backup.vhd > backup.hashes
[!bash!]$ grep "bitlocker\$0" backup.hashes > backup.hash
[!bash!]$ cat backup.hash
```

```shell-session
[!bash!]$ bitlocker2john -i Backup.vhd > backup.hashes
[!bash!]$ grep "bitlocker\$0" backup.hashes > backup.hash
[!bash!]$ cat backup.hash
```

After successfully cracking the password, we can access the encrypted drive.
#### Mounting BitLocker-encrypted drives in Windows

The easiest method for mounting a BitLocker-encrypted virtual drive on Windows is to double-click the `.vhd` file. Since it is encrypted, Windows will initially show an error. After mounting, simply double-click the BitLocker volume to be prompted for the password.

#### Mounting BitLocker-encrypted drives in Linux (or macOS)

It is also possible to mount BitLocker-encrypted drives in Linux (or macOS). To do this, we can use a tool called [dislocker](https://github.com/Aorimn/dislocker). First, we need to install the package using `apt`:

```shell-session
[!bash!]$ sudo apt-get install dislocker
```

Next, we create two folders which we will use to mount the VHD.

```shell-session
[!bash!]$ sudo mkdir -p /media/bitlocker
[!bash!]$ sudo mkdir -p /media/bitlockermount
```

We then use `losetup` to configure the VHD as [loop device](https://en.wikipedia.org/wiki/Loop_device), decrypt the drive using `dislocker`, and finally mount the decrypted volume:

```shell-session
[!bash!]$ sudo losetup -f -P Backup.vhd
[!bash!]$ sudo dislocker /dev/loop0p2 -u1234qwer -- /media/bitlocker
[!bash!]$ sudo mount -o loop /media/bitlocker/dislocker-file /media/bitl
```


```
# 1. Check which loop device was created
sudo losetup -l

# 2. List partitions on the loop device
sudo fdisk -l /dev/loop0

# 3. Run dislocker with correct syntax (note the space after --)
sudo dislocker /dev/loop0p1 -u francisco -- /media/bitlocker

# Alternative: If it prompts for password interactively
sudo dislocker /dev/loop0p1 -u -- /media/bitlocker
# Then enter 'francisco' when prompted

# 4. After dislocker succeeds, mount the decrypted file
sudo mount -o loop /media/bitlocker/dislocker-file /media/bitlockermount

# 5. Access your files
cd /media/bitlockermount
ls -la
```
