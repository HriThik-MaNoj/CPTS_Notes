
## Laudnum web shell
- basically a shell that we upload to a web server to get a connection back to our attack host.
- `Laudanum` is a repository of ready-made files that can be used to inject onto a victim and receive back access via a reverse shell, run commands on the victim host right from the browser, and more
- Laudanum can be found at `/usr/share/laudanum/aspx/shell.aspx`
- remeber to add own on ip in the `allowed ips` variable

## ASPX Explained
>Active Server Page Extended(ASPX)

- File type/extension written for [Microsoft's ASP.NET Framework](https://docs.microsoft.com/en-us/aspnet/overview).
- On a web server running the ASP.NET framework, web form pages can be generated for users to input data. On the server side, the information will be converted into HTML. We can take advantage of this by using an ASPX-based web shell to control the underlying Windows operating system.

## Antak Webshell
- webshell built in ASP.Net within the [Nishang project](https://github.com/samratashok/nishang).
- `Antak` utilizes PowerShell to interact with the host, making it great for acquiring a web shell on a Windows server.
- each command is run as a separate process.
- The Antak files can be found in the `/usr/share/nishang/Antak-WebShell` directory.
- Remember to change the default credentials and change those ascii stuff as they might be fingerprinted by detection systems.
- Uploading and executing the shell gives us a powershell like interface where we can execute powershell commands.
- we can use that powershell instance to get a reverse shell by using the powershell one liner we have in [[2. Reverse Shells]]
- tried the above.. it worked.

## PHP Web Shells

- rconfig 3.9.6 default credentials (admin:admin)
- For rconfig version 3.9.6, there is a vulnerability to manually upload a PHP webshell and interact with the underlying Linux host.
- login using default credentials
- Devices > Vendors and click Add Vendor.
- use the `whitewindterwolf's` php webshell.
#### Bypassing the File Type Restriction

With Burp open and our web browser proxy settings properly configured, we can now upload the PHP web shell. Click the browse button, navigate to wherever our .php file is stored on our attack box, and select open and `Save` (we may need to accept the PortSwigger Certificate). It will seem as if the web page is hanging, but that's just because we need to tell Burp to forward the HTTP requests. Forward requests until you see the POST request containing our file upload. It will look like this:

![[Pasted image 20260124054820.png]]

- Make sure to delete the comments left by the author and change any default values as these can give us away.
- We will change Content-type from `application/x-php` to `image/gif`. This will essentially "trick" the server and allow us to upload the .php file, bypassing the file type restriction.
##### Read this bro

- Depending on the engagement type (i.e., a black box evasive assessment), we may need to attempt to go undetected and `cover our tracks`. We are often helping our clients test their capabilities to detect a live threat, so we should emulate as much as possible the methods a malicious attacker may attempt, including attempting to operate stealthily. This will help our client and save us in the long run from having files discovered after an engagement period is over. In most cases, when attempting to gain a shell session with a target, it would be wise to establish a reverse shell and then delete the executed payload. Also, we must document every method we attempt, what worked & what did not work, and even the names of the payloads & files we tried to use. We could include a sha1sum or MD5 hash of the file name, upload locations in our reports as proof, and provide attribution.

