# Nibble Walkthrough

![[2025-12-17_06-58.png]]

---

## Enumeration

### Nmap Scan

```bash
nmap -sV --open 10.129.200.170
# performs a service version enumeration of the ports.
```

![[attachments/Pasted image 20251217070408.png]]

The nmap scan revealed 2 open ports: SSH and HTTP. We were also able to find that `Apache httpd 2.4.18` is running on the HTTP port.

### Web Enumeration

Let's try to find what is running on the web server by opening it in our browser:

![[attachments/Pasted image 20251217070642.png]]

There's nothing here... let's check the source for this page. We can see an interesting comment:

![[attachments/Pasted image 20251217070817.png]]

Let's go to that directory:

![[attachments/Pasted image 20251217071019.png]]

I tried clicking on all the links here... no luck! So I moved on to checking the source code for this page and found something interesting - some other directories mentioned:

![[attachments/Pasted image 20251217071325.png]]

When I opened that directory and went back to its parent directory, I found some more directories:

![[attachments/Pasted image 20251217072707.png]]

I went through all these directories and couldn't find anything interesting...

### Gobuster

So I decided to enumerate again with gobuster:

```bash
gobuster dir -u http://10.129.200.170/nibbleblog/ -w /usr/share/seclists/Discovery/Web-Content/common.txt
```

**Output:**

![[attachments/Pasted image 20251217073047.png]]

### Version Discovery

Looking at the `README` file, we can see that they are running NibbleBlog version `v4.0.3`:

![[attachments/Pasted image 20251217074500.png]]

Doing a bit of research on that particular version gave us a lot of information:

![[attachments/Pasted image 20251217074758.png]]

### Finding Credentials

We need the admin credentials. Found an interesting file called `users.xml`:

![[attachments/Pasted image 20251217075619.png]]

Inside that, we got our username as `admin`:

![[attachments/Pasted image 20251217075730.png]]

We still don't have the password. Upon research, we found that there is no default password - it's set during setup. Bruteforce protection is also implemented, so we're not going that route.

After a bit of guessing... tried the password `nibbles` and it worked! Now we have the admin credentials.

## Exploitation

Let's try to exploit it using Metasploit. Upon searching in msfconsole:

![[attachments/Pasted image 20251217080415.png]]

Setting the required options:

![[attachments/Pasted image 20251217082052.png]]

And run the exploit. Exploit ran successfully!

Now we need to run the shell command to get a shell and then upgrade the TTY to a proper shell. Refer to [[2. Upgrading TTY]] for additional details.

For this box, we're trying to spawn a bash shell using Python. I tried python2 but it was not installed, so using python3 instead.

Got a bash shell now:

![[attachments/Pasted image 20251217082642.png]]

## Privilege Escalation

Let's run `sudo -l` to list the allowed commands for the current user nibbler on the host:

![[attachments/Pasted image 20251217083100.png]]

We can run `/home/nibbler/personal/stuff/monitor.sh` without password as root.

I checked and this file doesn't exist. So let's create it and make it run a bash shell:

![[attachments/Pasted image 20251217083409.png]]

Now let's try running it to achieve root:

![[attachments/Pasted image 20251217084009.png]]

> **Note:** We can also do this manually without using Metasploit - refer to HackTheBox writeups for that.

---

See also: [[2. Upgrading TTY]], [[1. Nmap]]