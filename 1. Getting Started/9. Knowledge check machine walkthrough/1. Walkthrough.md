# Knowledge Check Machine Walkthrough

---

## Enumeration

### Nmap Scan (All Ports)

![[attachments/Pasted image 20251217092241.png]]

Only HTTP and SSH are open. Let's enumerate further with nmap and see if we can find anything else:

![[attachments/Pasted image 20251217092550.png]]

Seems like we have an `/admin` directory.

### Gobuster

Let's try using gobuster and see if we can find more directories:

![[attachments/Pasted image 20251217094002.png]]

## Initial Access

Went to the admin page and saw a login form. Tried the username `admin` and password `admin`... and boom! Logged in as admin:

![[attachments/Pasted image 20251217094130.png]]

After poking around a bit, I found that in the theme's section there is an option to edit themes. The themes are written in PHP, so why not edit the theme and put a PHP reverse shell in there:

![[attachments/Pasted image 20251218052318.png]]

And we got a connection back at our nc listener!

![[attachments/Pasted image 20251218052407.png]]

### Upgrading TTY

Let's upgrade the TTY using Python command (refer to [[2. Upgrading TTY]]):

```bash
python3 -c 'import pty; pty.spawn("/bin/bash")'
```

![[attachments/Pasted image 20251218052517.png]]

### User Flag

Went to the home directory and got the user flag:

![[attachments/Pasted image 20251218053319.png]]

## Privilege Escalation

Now we need to escalate our privileges and get root:

```bash
sudo -l
# To know what the current user can run with root permission without root password.
```

![[attachments/Pasted image 20251218053523.png]]

So we need to run the PHP command to get root. After a bit of research:

![[attachments/Pasted image 20251218054057.png]]

### Got Root!

![[attachments/Pasted image 20251218054142.png]]

Now let's upgrade that shell as well and then go get the root flag:

![[attachments/Pasted image 20251218054317.png]]

**Done!**

---

See also: [[2. Upgrading TTY]], [[1. Privilege Escalation]]