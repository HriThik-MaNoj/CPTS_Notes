# Enumeration

> `Enumeration is the key`

Nmap is written in C, C++, Python and Lua. It can be divided into the following scanning techniques:

1. Host discovery
2. Port scanning
3. Service enumeration and detection
4. OS detection
5. Scriptable interaction with the target service (Nmap Scripting Engine)

---

## Syntax

```bash
nmap <scan types> <options> <target>
```

## TCP-SYN Scan (-sS)

- Default setting unless we define otherwise.
- Can scan thousands of ports per second.
- `Sends one packet with the SYN flag`, therefore, never completes the `three-way handshake`, which results in not establishing a full TCP connection to the scanned port.
- If our target sends a `SYN-ACK` flagged packet back to us, Nmap detects that the port is `open`.
- If the target responds with an `RST` flagged packet, it is an indicator that the port is `closed`.
- If Nmap does not receive a packet back, it will display it as `filtered`. Depending on the firewall configuration, certain packets may be dropped or ignored by the firewall.

## TCP Connect Scan (-sT)

- Highly Accurate but not stealthy
- Uses the three-way handshake to determine if a specific port on a target host is open or closed.
- Sends an `SYN` packet to the target port and waits for a response. It is considered open if the target port responds with an `SYN-ACK` packet and closed if it responds with an `RST` packet.

## Service Enumeration

- It is recommended to perform a quick port scan first, which gives us a small overview of the available ports. This causes significantly less traffic (else we may be discovered and blocked by the security mechanisms).

### Stats Every X Seconds

Defining how periods of time the status should be shown:

```bash
sudo nmap 10.129.2.28 -p- -sV --stats-every=5s
# shows the progress of the scan every 5s
```

---

See also: [[2. Host Discovery]], [[3. Host and Port Scanning]], [[4. Saving the Results]]
